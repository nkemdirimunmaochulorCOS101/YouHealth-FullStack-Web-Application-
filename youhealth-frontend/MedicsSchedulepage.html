<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>YouHealth Practitioner - Tasks</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Inter', sans-serif; }
    .nav-link.active {
      font-weight: 700; color: #1e3a8a;
      border-bottom: 2px solid #1e3a8a; padding-bottom: 2px;
    }
    .task-card:hover { background-color: #f1f5f9; transform: scale(1.01); transition: 0.2s; }
  </style>
</head>
<body class="bg-blue-900 text-slate-800">

<!-- Header -->
<header class="bg-white shadow-sm sticky top-0 z-50">
  <div class="flex items-center justify-between max-w-7xl mx-auto px-4 py-2 md:px-6">
    <!-- Logo -->
    <div class="flex items-center space-x-2">
      <img src="istockphoto-1321617070-612x612-removebg-preview.png" alt="YouHealth Logo" class="h-10 w-10 rounded-xl">
      <a href="index.html" class="text-xl md:text-2xl font-extrabold tracking-wide text-blue-900 cursor-pointer">YouHealth</a>
    </div>

    <!-- Desktop nav -->
    <nav class="hidden md:flex space-x-8 mx-auto">
      <a href="MedicsDashboard.html" class="nav-link">Dashboard</a>
      <a href="Medicspatientpage.html" class="nav-link">Patients</a>
      <a href="#" class="nav-link active">Tasks</a>
      <a href="MedicsSettingspage.html" class="nav-link">Settings</a>
    </nav>

    <!-- Right section -->
    <div class="flex items-center space-x-4">
      <button id="hamburger-btn" class="md:hidden text-blue-900 focus:outline-none" aria-label="Open menu">
        <svg xmlns="http://www.w3.org/2000/svg" class="h-7 w-7" fill="none" viewBox="0 0 24 24" stroke="currentColor">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M4 6h16M4 12h16M4 18h16" />
        </svg>
      </button>
      <button id="sign-out-btn" class="hidden sm:block px-3 py-1 md:px-4 md:py-2 rounded-full text-white font-semibold bg-blue-900 hover:bg-blue-700 transition">
        Log Out
      </button>
    </div>
  </div>
</header>

<!-- Mobile nav -->
<div id="mobile-menu" class="hidden md:hidden absolute top-16 left-3 w-full bg-white shadow-lg z-40">
  <nav class="flex flex-col items-center py-4 space-y-4">
    <a href="MedicsDashboard.html" class="nav-link text-lg font-medium text-gray-600 hover:text-blue-900">Dashboard</a>
    <a href="Medicspatientpage.html" class="nav-link text-lg font-medium text-gray-600 hover:text-blue-900">Patients</a>
    <a href="#" class="nav-link text-lg font-bold text-blue-900">Tasks</a>
    <a href="MedicsSettingspage.html" class="nav-link text-lg font-medium text-gray-600 hover:text-blue-900">Settings</a>
    <button id="sign-out-btn" class="w-full text-center text-lg font-medium py-2 px-4 rounded-full text-white bg-blue-900 hover:bg-blue-700 transition mt-4">Log Out</button>
  </nav>
</div>

<!-- Page Content -->
<div class="flex-1 p-4 md:p-8 overflow-y-auto">
  <main class="page-content active max-w-7xl mx-auto">
    
    <h2 class="text-3xl md:text-4xl font-bold text-white mb-6">📝 Task Manager</h2>

    <!-- Add Task -->
    <div class="bg-white rounded-xl shadow-lg p-6 mb-8">
      <h3 class="text-xl font-semibold text-gray-900 mb-4">Add New Task</h3>
      <form id="taskForm" class="flex flex-col gap-4">
        <input type="text" id="taskInput" placeholder="Enter task..." required 
               class="p-3 rounded-lg border border-gray-300 focus:ring-2 focus:ring-blue-400 outline-none"/>
        <div class="flex gap-4">
          <select id="priority" class="p-3 rounded-lg border border-gray-300 flex-1">
            <option value="Low">🟢 Low</option>
            <option value="Medium">🟡 Medium</option>
            <option value="High">🔴 High</option>
          </select>
          <input type="date" id="dueDate" class="p-3 rounded-lg border border-gray-300 flex-1"/>
        </div>
        <button type="submit" 
                class="bg-blue-600 text-white p-3 rounded-lg font-semibold shadow hover:bg-blue-700 transition">
          ➕ Add Task
        </button>
      </form>
    </div>

    <!-- Task List -->
    <div class="bg-white rounded-xl shadow-lg p-6">
      <h3 class="text-xl font-semibold text-gray-900 mb-4">Your Tasks</h3>
      <div id="taskList" class="space-y-4"></div>
      <button id="clearTasks" class="mt-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow hover:bg-red-600 transition">
        Clear All
      </button>
    </div>

  </main>
</div>

<!-- Script -->
<script>
  const taskForm = document.getElementById("taskForm");
  const taskInput = document.getElementById("taskInput");
  const taskList = document.getElementById("taskList");
  const clearTasksBtn = document.getElementById("clearTasks");

  let tasks = JSON.parse(localStorage.getItem("tasks")) || [];

  function saveTasks() { localStorage.setItem("tasks", JSON.stringify(tasks)); }

  function renderTasks() {
    taskList.innerHTML = "";
    if (tasks.length === 0) {
      taskList.innerHTML = `<p class="text-gray-500">No tasks yet.</p>`;
      return;
    }
    tasks.forEach((task, i) => {
      const card = document.createElement("div");
      card.className = "task-card bg-gray-50 p-4 rounded-lg shadow flex justify-between items-center";
      card.innerHTML = `
        <div>
          <p class="font-semibold ${task.completed ? 'line-through text-gray-400' : ''}">
            ${task.description}
          </p>
          <p class="text-sm text-gray-500">Priority: ${task.priority} | Due: ${task.dueDate || "N/A"}</p>
        </div>
        <div class="flex gap-2">
          <button onclick="toggleComplete(${i})" 
                  class="px-3 py-1 rounded-lg text-white ${task.completed ? 'bg-green-500' : 'bg-gray-500'}">
            ${task.completed ? "✔ Done" : "Mark Done"}
          </button>
          <button onclick="deleteTask(${i})" 
                  class="px-3 py-1 rounded-lg bg-red-500 text-white">🗑</button>
        </div>`;
      taskList.appendChild(card);
    });
  }

  taskForm.addEventListener("submit", (e) => {
    e.preventDefault();
    const newTask = {
      description: taskInput.value,
      priority: document.getElementById("priority").value,
      dueDate: document.getElementById("dueDate").value,
      completed: false
    };
    tasks.push(newTask);
    saveTasks();
    renderTasks();
    taskForm.reset();
    checkReminders();
  });

  function toggleComplete(i) { tasks[i].completed = !tasks[i].completed; saveTasks(); renderTasks(); }
  function deleteTask(i) { tasks.splice(i,1); saveTasks(); renderTasks(); }

  clearTasksBtn.addEventListener("click", () => { tasks=[]; saveTasks(); renderTasks(); });

  // 🔔 Check for reminders
  function checkReminders() {
    const today = new Date();
    const tomorrow = new Date(today);
    tomorrow.setDate(today.getDate() + 1);

    tasks.forEach(task => {
      if (task.dueDate) {
        const taskDate = new Date(task.dueDate + "T00:00:00");
        if (
          taskDate.getFullYear() === tomorrow.getFullYear() &&
          taskDate.getMonth() === tomorrow.getMonth() &&
          taskDate.getDate() === tomorrow.getDate()
        ) {
          showReminder(task.description, task.dueDate);
        }
      }
    });
  }

  // 📢 Show reminder popup
  function showReminder(taskDescription, dueDate) {
    alert(`🔔 Reminder: "${taskDescription}" is due tomorrow (${dueDate}).`);
    
    // Optional: Push browser notification
    if (Notification.permission === "granted") {
      new Notification("YouHealth Task Reminder", {
        body: `"${taskDescription}" is due tomorrow (${dueDate}).`,
        icon: "istockphoto-1321617070-612x612-removebg-preview.png"
      });
    }
  }

  // Request permission for browser notifications
  if ("Notification" in window && Notification.permission !== "granted") {
    Notification.requestPermission();
  }

  renderTasks();
  checkReminders();

  // ✅ Mobile menu toggle
  const hamburgerBtn = document.getElementById("hamburger-btn");
  const mobileMenu = document.getElementById("mobile-menu");

  hamburgerBtn.addEventListener("click", () => {
    mobileMenu.classList.toggle("hidden");
  });
</script>

</body>
</html>
